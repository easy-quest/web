# Linux Terminal ч.5 | ln | Создание ссылок (Ярлыки в Linux)

10 июня

Последние статьи я стараюсь писать таким образом, чтобы для полного понимания  материала Вам не пришлось перечитывать весь предыдущий материал, но от  использования основных команд (cd, ls и т.д.) отказаться невозможно,  поэтому если Вы только начинаете знакомство с терминалом Linux, лучше  изучить мои предыдущие статьи по данной теме. Это **не займёт** у Вас **много времени** и **существенно облегчит понимание** изложенного материала:

- [[01_Linux_Terminal | Часть 1]]
- [[02_Linux_Terminal | Часть 2]]
- [[03_Linux_Terminal | Часть 3]]
- [[04_Linux_Terminal | Часть 4 ]]

## Теория о ссылках в Linux

В Linux существует два типа ссылок: **жёсткие** и **символические**. Для создания обоих служит команда ln (**l**i**n**k - ссылка) с небольшим отличием в параметрах.

Синтаксис **для жёстких** ссылок:

> ln файл ссылка



**Для символических**:

> ln -s элемент ссылка

*В отличие от жёстких ссылок, в символических в качестве элемента можно указать как файл, так и каталог.

### Жёсткие ссылки

Жёсткие ссылки являются первоначальным способом создания ссылок в Unix. Всё  дело в том, что по умолчанию каждый файл имеет одну жёсткую ссылку (своё абсолютное имя).

> Тут следует пояснить кое-что из школьного курса информатики: у каждого  файла есть так называемое полное (иногда оно называется абсолютным) имя, которое начинается с корня файловой системы (в Unix это, например:  '/home/it-doc/Документы/Сценарий к ролику.odt') или буквы жёсткого диска (актуально для Windows, например:  'D:\Systemfolders\Documents\Накладная.docx'). Имя файла без абсолютного  пути называется относительным, но в обиходе в основном указывается  просто как имя файла.



Жёсткие ссылки имеют два важных ограничения:

1. Они не могут указывать на файл за пределами собственной файловой системы.
2. Жёсткие ссылки не могут указывать на каталог.

В отличие от символических ссылок, при выводе содержимого каталога  жёсткие ссылки никак не выделяются. И хотя они неотличимы от самого  файла, при их удалении исходный файл остаётся на месте. 

Оговорюсь, что в современной практике предпочтение отдаётся символическим ссылкам, но знать о существовании жёстких ссылок всё-таки необходимо, так как  когда-нибудь они Вам обязательно встретятся.

### Символические ссылки

Символические ссылки (симлинки) были придуманы для того, чтобы преодолеть ограничения своих предшественников. При создании символической ссылки на самом деле создаётся файл особого типа, который содержит текстовый указатель на  файл или каталог. В каком-то смысле они работают как ярлыки в Windows,  только появились задолго до последних.

Сама симлинк и файл, на который она указывает, практически неотличимы друг  от друга (если попытаться что-то записать в символическую ссылку, запись будет выполнена в файл, на который она указывает. Удаление симлинка не  затронет исходный файл, но в отличие от жёстких ссылок, удалить файл при наличии симлинков **можно**, но в таком  случае оставшаяся символическая ссылка будет указывать в никуда. Такие  ссылки называют "битыми" и во многих дистрибутивах команда ls их  выделяет цветом (обычно красным). Это сделано для того, чтобы  пользователь обратил на них внимание. 

Даже если Вы мало что поняли из вышесказанного, не расстраивайтесь!  Запускайте терминал и выполняйте команды, описанные в практической части параллельно с чтением статьи. Для лучшего понимания постарайтесь не  бояться выполнять свои примеры, пусть они и будут по началу похожи на  примеры из статьи :)

## Создание ссылок в терминале Linux

Для начала создадим временный каталог и перейдём в него:

> mkdir /tmp/links && cd /tmp/links

Теперь создадим парочку текстовых файлов, над которыми будем ставить эксперименты:

> echo "Текстовый файл для игр со ссылками" > file.txt

> *echo "Второй текстовый файл для игр со ссылками" > file2.txt*

### Создание жёстких ссылок в терминале Linux

Для начала попробуем создать жёсткую ссылку на файл в той же директории: 

> ln file.txt file_link.txt

Здесь: 

- ln - вызов команды для создания ссылок
- file.txt - файл, на который нужно создать ссылку
- file_link.txt - имя жёсткой ссылки

Теперь выведем подробный список содержимого нашего каталога:

Подробный вывод содержимого каталога /tmp/links

Как видим, *file.txt* имеет 2 жёсткие ссылки (если внимательно читали статью, то знаете почему именно 2, а не 1). Мы знаем, что *file_link.txt* и *file.txt* - это один и тот же файл, т.к. именно мы принимали участие в их создании, но как быть в других случаях? 

> Снова обратимся к теории (очень упрощённо). Информация хранится на носителях  блоками. Как правило, для хранения файла требуется несколько таких  блоков, объединение которых называется индексным узлом. То есть  созданная нами жёсткая ссылка указывает на тот адрес индексного узла, в  котором "лежит" исходный файл. 

Теперь осталось получить информацию об этих адресах и сравнить их. В этом нам поможет параметр *i* команды *ls:*

Расширенный вывод содержимого /tmp/links, включающий адреса индексных узлов

Первый столбец и есть адрес индексного узла, в котором находится файл. Как мы видим, у двух файлов он одинаков,значит *file_link.txt* и *file.txt* - это один и тот же файл.

### Создание символических ссылок в терминале Linux

Симлинки призваны преодолеть ограничения жёстких ссылок. Они представляют собой  файл особого типа, в котором хранится текстовый указатель на файл или  каталог.

Создаются симлинки почти так же, как и жёсткие ссылки:

Как видим, симлинки выделяются цветным текстом и указатель на реальный  файл. Буква l в первом столбце также говорит нам о том, что это ссылка.  Размер файла, равный 8 - это число символов в указателе на реальный  файл.

Но что, если попробовать создать подкаталог и символическую ссылку на него?

Как видим, с этой задачей симлинки справляются без проблем, но что с адресами индексных узлов? 

Логично, что они будут отличаться, ведь это всего лишь файл, содержащий путь к  другому файлу, а значит, при перемещении симлинка (если в ней указан  относительный путь к файлу), она станет "битой":

Что же касается жёстких ссылок, то им эта участь не страшна, т.к. они "привязаны" адресами индексных узлов:

 

> В симлинках могут использоваться как абсолютные, так и относительные  пути! Всегда помните об этом и используйте наиболее приемлемый для той  или иной ситуации вариант. 

### Создание ссылок в графическом интерфейсе Linux

Т.к. в повседневной работе большинство используют файловые менеджеры с  графическим интерфейсом, то стоит упомянуть о возможности создания в них символических ссылок. Изложенное ниже наиболее актуально для GNOME и  его производных:

> Если в GNOME во время перетаскивания файла мышью удерживать нажатыми клавиши CTRL и SHIFT, вместо копирования (или перемещения) будет выполнена  операция создания символической ссылки



**Следующая часть:  [[06_Linux_Terminal | Linux Terminal ч.6]] (создание собственных команд):** 

На этом я завершаю знакомство со ссылками в Linux. Как обычно, самые любознательные всегда могут заглянуть в '*man ln'.* Спасибо, что дочитали статью до конца. Всего Вам доброго!